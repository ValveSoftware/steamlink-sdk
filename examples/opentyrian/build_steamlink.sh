#!/bin/bash
#

TOP=$(cd `dirname "${BASH_SOURCE[0]}"` && pwd)
if [ "${MARVELL_SDK_PATH}" = "" ]; then
	MARVELL_SDK_PATH="$(cd "${TOP}/../.." && pwd)"
fi
if [ "${MARVELL_ROOTFS}" = "" ]; then
	source "${MARVELL_SDK_PATH}/setenv.sh" || exit 1
fi
BUILD="${PWD}"
SRC="${BUILD}/opentyrian-src"

#
# Download the source
#
if [ ! -d "${SRC}" ]; then
	hg clone https://bitbucket.org/opentyrian/opentyrian "${SRC}"
	(cd "${SRC}"; hg update sdl2)
	rm -f "${BUILD}/.patch-applied"
fi

#
# Apply any patches
#
if [ "${TOP}/opentyrian.patch" -nt "${BUILD}/.patch-applied" ]; then
	pushd "${SRC}"
	hg checkout -C
	patch -p1 <"${TOP}/opentyrian.patch" || exit 1
	popd
	touch "${BUILD}/.patch-applied"
fi

#
# Build it
#
pushd "${SRC}"
make PLATFORM=STEAMLINK MAKECMDGOALS=release || exit 1
popd

#
# Get the data file
#
if [ ! -f tyrian21.zip ]; then
	wget http://camanis.net/tyrian/tyrian21.zip
fi

export APPSDIR="${BUILD}/steamlink/apps"
export DESTDIR="${APPSDIR}/tyrian21"

# Copy the files to the app directory
mkdir -p "${APPSDIR}"
(cd "${APPSDIR}"; rm -rf tyrian21; unzip ${BUILD}/tyrian21.zip)
cp -v "${SRC}/opentyrian" "${DESTDIR}/opentyrian" || exit 1
$STRIP "${DESTDIR}/opentyrian"

# Create the table of contents and icon
cat >"${DESTDIR}/toc.txt" <<__EOF__
name=Tyrian
icon=icon.png
run=opentyrian
__EOF__

base64 -d >"${DESTDIR}/icon.png" <<__EOF__
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
ydaJFnwAAAAASUVORK5CYII=
__EOF__

# Pack it up
name=$(basename ${DESTDIR})
pushd "$(dirname ${DESTDIR})"
tar zcvf $name.tgz $name || exit 3
rm -rf $name
popd

# All done!
echo "Build complete!"
echo
echo "Put the steamlink folder onto a USB drive, insert it into your Steam Link, and cycle the power to install."
