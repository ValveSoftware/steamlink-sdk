# Copyright 2014 The Chromium Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("//build/config/features.gni")
import("//build/config/ui.gni")
import("//testing/libfuzzer/fuzzer_test.gni")
import("//testing/test.gni")
import("//third_party/WebKit/public/public_features.gni")
import("//third_party/WebKit/Source/build/scripts/scripts.gni")
import("//third_party/WebKit/Source/config.gni")
import("//third_party/WebKit/Source/platform/platform_generated.gni")

# Most targets in this file are private actions so use that as the default.
visibility = [ ":*" ]

blink_platform_neon_files = [ "graphics/cpu/arm/WebGLImageConversionNEON.h" ]

blink_platform_msa_files = [ "graphics/cpu/mips/WebGLImageConversionMSA.h" ]

blink_platform_sse_files = [ "graphics/cpu/x86/WebGLImageConversionSSE.h" ]

component("blink_common") {
  visibility = []  # Allow re-assignment of list.
  visibility = [ "//third_party/WebKit/*" ]
  sources = [
    "../web/WebInputEvent.cpp",
    "exported/FilePathConversion.cpp",
    "exported/URLConversion.cpp",
    "exported/WebCString.cpp",
    "exported/WebString.cpp",
    "exported/linux/WebFontRenderStyle.cpp",
  ]
  if (is_android) {
    set_sources_assignment_filter([])
    sources += [ "exported/linux/WebFontRenderStyle.cpp" ]
  }

  defines = [
    "BLINK_COMMON_IMPLEMENTATION=1",
    "INSIDE_BLINK",
  ]

  configs += [
    "//build/config/compiler:wexit_time_destructors",
    "//third_party/WebKit/Source:config",
    "//third_party/WebKit/Source:non_test_config",
  ]

  deps = [
    "//base",
    "//third_party/WebKit/Source/wtf",
    "//url",
  ]

  public_deps = [
    "//skia",
  ]
}

action("font_family_names") {
  script = "../build/scripts/make_names.py"

  font_family_names_in = "fonts/FontFamilyNames.in"
  inputs = make_names_files + [ font_family_names_in ]

  outputs = [
    "$blink_platform_output_dir/FontFamilyNames.cpp",
    "$blink_platform_output_dir/FontFamilyNames.h",
  ]

  args = [
    rebase_path(font_family_names_in, root_build_dir),
    "--output_dir",
    rebase_path(blink_platform_output_dir, root_build_dir),
  ]
}

action("http_names") {
  script = "../build/scripts/make_names.py"

  http_names_in = "network/HTTPNames.in"
  inputs = make_names_files + [ http_names_in ]

  outputs = [
    "$blink_platform_output_dir/HTTPNames.cpp",
    "$blink_platform_output_dir/HTTPNames.h",
  ]

  args = [
    rebase_path(http_names_in, root_build_dir),
    "--output_dir",
    rebase_path(blink_platform_output_dir, root_build_dir),
  ]
}

action("runtime_enabled_features") {
  script = "../build/scripts/make_runtime_features.py"

  runtime_enabled_features_in = "RuntimeEnabledFeatures.in"
  inputs = scripts_for_in_files + [
             runtime_enabled_features_in,
             "../build/scripts/templates/RuntimeEnabledFeatures.cpp.tmpl",
             "../build/scripts/templates/RuntimeEnabledFeatures.h.tmpl",
           ]

  outputs = [
    "$blink_platform_output_dir/RuntimeEnabledFeatures.cpp",
    "$blink_platform_output_dir/RuntimeEnabledFeatures.h",
  ]

  args = [
    rebase_path(runtime_enabled_features_in, root_build_dir),
    "--output_dir",
    rebase_path(blink_platform_output_dir, root_build_dir),
  ]
}

action("color_data") {
  script = "../build/scripts/gperf.py"

  color_data_gperf = "ColorData.gperf"
  inputs = [
    color_data_gperf,
  ]

  output_file = "$blink_platform_output_dir/ColorData.cpp"
  outputs = [
    output_file,
  ]

  args = []
  if (is_mac && !use_system_xcode) {
    args += [
      "--developer_dir",
      hermetic_xcode_path,
    ]
  }

  args += [
    gperf_exe,
    "--key-positions=*",
    "-D",
    "-s",
    "2",
    rebase_path(color_data_gperf, root_build_dir),
    "--output-file=" + rebase_path(output_file, root_build_dir),
  ]
}

action("character_data") {
  script = "../build/scripts/gperf.py"
  deps = [
    ":character_data_generator($host_toolchain)",
  ]
  output_file = "$blink_platform_output_dir/CharacterPropertyData.cpp"
  outputs = [
    output_file,
  ]

  # Find character_data_generator, which is generated in a different directory
  # when cross-compile.
  generator = "./" + rebase_path(
                  get_label_info(":character_data_generator($host_toolchain)",
                                 "root_out_dir") + "/character_data_generator",
                  root_build_dir)
  args = [
    generator,
    rebase_path(output_file, root_build_dir),
  ]
}

executable("character_data_generator") {
  sources = [
    "text/CharacterPropertyDataGenerator.cpp",
    "text/CharacterPropertyDataGenerator.h",
  ]
  configs += [ "//third_party/WebKit/Source:config" ]
  deps = [
    "//build/config/sanitizers:deps",

    # Default manifest on Windows (a no-op elsewhere).
    "//build/win:default_exe_manifest",
    "//third_party/icu",
  ]
}

# This isn't strictly necessary since we can just add the deps to "platform",
# but it helps to have the targets match the GYP build.
group("make_platform_generated") {
  visibility = []  # Allow re-assignment of list.
  visibility = [ "//third_party/WebKit/Source/*" ]
  public_deps = [
    ":blink_common",
    ":character_data",
    ":color_data",
    ":font_family_names",
    ":http_names",
    ":runtime_enabled_features",
  ]
}

component("platform") {
  visibility = []  # Allow re-assignment of list.
  visibility = [
    "//third_party/WebKit/*",
    "//url/mojo:url_mojom_origin_blink_cpp_sources",
    "//url/mojo:url_mojom_gurl_blink_cpp_sources",
  ]
  output_name = "blink_platform"

  sources = [
    "AsyncFileSystemCallbacks.h",
    "CalculationValue.h",
    "ContentDecryptionModuleResult.h",
    "ContentSettingCallbacks.cpp",
    "ContentSettingCallbacks.h",
    "ContentType.cpp",
    "ContentType.h",
    "ContextMenu.cpp",
    "ContextMenu.h",
    "ContextMenuItem.cpp",
    "ContextMenuItem.h",
    "CrossThreadCopier.cpp",
    "CrossThreadCopier.h",
    "Crypto.cpp",
    "Crypto.h",
    "CryptoResult.h",
    "Cursor.cpp",
    "Cursor.h",
    "DateComponents.cpp",
    "DateComponents.h",
    "Decimal.cpp",
    "Decimal.h",
    "DragImage.cpp",
    "DragImage.h",
    "EventDispatchForbiddenScope.cpp",
    "EventDispatchForbiddenScope.h",
    "FileChooser.cpp",
    "FileChooser.h",
    "FileMetadata.cpp",
    "FileMetadata.h",
    "FileSystemType.h",
    "Histogram.cpp",
    "Histogram.h",
    "HostWindow.h",
    "InstanceCounters.cpp",
    "InstanceCounters.h",
    "KeyboardCodes.h",
    "KillRing.h",
    "KillRingNone.cpp",
    "Language.cpp",
    "Language.h",
    "LayoutLocale.cpp",
    "LayoutLocale.h",
    "LayoutTestSupport.cpp",
    "LayoutTestSupport.h",
    "LayoutUnit.cpp",
    "LayoutUnit.h",
    "Length.cpp",
    "Length.h",
    "LengthBox.cpp",
    "LengthBox.h",
    "LengthFunctions.cpp",
    "LengthFunctions.h",
    "LengthPoint.h",
    "LengthSize.h",
    "LifecycleNotifier.h",
    "LifecycleObserver.h",
    "LinkHash.cpp",
    "LinkHash.h",
    "MIMETypeFromURL.cpp",
    "MIMETypeFromURL.h",
    "MIMETypeRegistry.h",
    "MemoryCoordinator.cpp",
    "MemoryCoordinator.h",
    "PODArena.h",
    "PODFreeListArena.h",
    "PODInterval.h",
    "PODIntervalTree.h",
    "PODRedBlackTree.h",
    "PartitionAllocMemoryDumpProvider.cpp",
    "PartitionAllocMemoryDumpProvider.h",
    "PasteMode.h",
    "PlatformEvent.h",
    "PlatformGestureEvent.h",
    "PlatformInstrumentation.cpp",
    "PlatformInstrumentation.h",
    "PlatformMouseEvent.h",
    "PlatformResourceLoader.cpp",
    "PlatformResourceLoader.h",
    "PlatformTouchEvent.h",
    "PlatformTouchPoint.h",
    "PlatformWheelEvent.h",
    "PluginScriptForbiddenScope.cpp",
    "PluginScriptForbiddenScope.h",
    "PopupMenu.h",
    "Prerender.cpp",
    "Prerender.h",
    "PrerenderClient.h",
    "ScopedOrientationChangeIndicator.cpp",
    "ScopedOrientationChangeIndicator.h",
    "ScriptForbiddenScope.cpp",
    "ScriptForbiddenScope.h",
    "SecureTextInput.cpp",
    "SecureTextInput.h",
    "SerializedResource.h",
    "SharedBuffer.cpp",
    "SharedBuffer.h",
    "SharedBufferChunkReader.cpp",
    "SharedBufferChunkReader.h",
    "StorageQuotaCallbacks.h",
    "Supplementable.cpp",
    "Supplementable.h",
    "Theme.cpp",
    "Theme.h",
    "ThemeTypes.h",
    "Timer.cpp",
    "Timer.h",
    "UUID.cpp",
    "UUID.h",
    "UserGestureIndicator.cpp",
    "UserGestureIndicator.h",
    "WaitableEvent.cpp",
    "WaitableEvent.h",
    "WebIconSizesParser.cpp",
    "WebScheduler.cpp",
    "WebTaskRunner.cpp",
    "WebTaskRunner.h",
    "WebTextInputInfo.cpp",
    "WebThread.cpp",
    "WebThreadSupportingGC.cpp",
    "WebThreadSupportingGC.h",
    "WebURLLoader.cpp",
    "Widget.cpp",
    "Widget.h",
    "WindowsKeyboardCodes.h",
    "animation/AnimationTranslationUtil.cpp",
    "animation/AnimationTranslationUtil.h",
    "animation/AnimationUtilities.h",
    "animation/CompositorAnimation.cpp",
    "animation/CompositorAnimation.h",
    "animation/CompositorAnimationCurve.h",
    "animation/CompositorAnimationDelegate.h",
    "animation/CompositorAnimationHost.cpp",
    "animation/CompositorAnimationHost.h",
    "animation/CompositorAnimationPlayer.cpp",
    "animation/CompositorAnimationPlayer.h",
    "animation/CompositorAnimationPlayerClient.cpp",
    "animation/CompositorAnimationPlayerClient.h",
    "animation/CompositorAnimationTimeline.cpp",
    "animation/CompositorAnimationTimeline.h",
    "animation/CompositorFilterAnimationCurve.cpp",
    "animation/CompositorFilterAnimationCurve.h",
    "animation/CompositorFilterKeyframe.cpp",
    "animation/CompositorFilterKeyframe.h",
    "animation/CompositorFloatAnimationCurve.cpp",
    "animation/CompositorFloatAnimationCurve.h",
    "animation/CompositorFloatKeyframe.cpp",
    "animation/CompositorFloatKeyframe.h",
    "animation/CompositorKeyframe.cpp",
    "animation/CompositorKeyframe.h",
    "animation/CompositorScrollOffsetAnimationCurve.cpp",
    "animation/CompositorScrollOffsetAnimationCurve.h",
    "animation/CompositorTargetProperty.h",
    "animation/CompositorTransformAnimationCurve.cpp",
    "animation/CompositorTransformAnimationCurve.h",
    "animation/CompositorTransformKeyframe.cpp",
    "animation/CompositorTransformKeyframe.h",
    "animation/CompositorTransformOperations.cpp",
    "animation/CompositorTransformOperations.h",
    "animation/TimingFunction.cpp",
    "animation/TimingFunction.h",
    "audio/AudioArray.h",
    "audio/AudioBus.cpp",
    "audio/AudioBus.h",
    "audio/AudioChannel.cpp",
    "audio/AudioChannel.h",
    "audio/AudioDSPKernel.cpp",
    "audio/AudioDSPKernel.h",
    "audio/AudioDSPKernelProcessor.cpp",
    "audio/AudioDSPKernelProcessor.h",
    "audio/AudioDelayDSPKernel.cpp",
    "audio/AudioDelayDSPKernel.h",
    "audio/AudioDestination.cpp",
    "audio/AudioDestination.h",
    "audio/AudioDestinationConsumer.h",
    "audio/AudioFIFO.cpp",
    "audio/AudioFIFO.h",
    "audio/AudioFileReader.h",
    "audio/AudioIOCallback.h",
    "audio/AudioProcessor.cpp",
    "audio/AudioProcessor.h",
    "audio/AudioPullFIFO.cpp",
    "audio/AudioPullFIFO.h",
    "audio/AudioResampler.cpp",
    "audio/AudioResampler.h",
    "audio/AudioResamplerKernel.cpp",
    "audio/AudioResamplerKernel.h",
    "audio/AudioSourceProvider.h",
    "audio/AudioSourceProviderClient.h",
    "audio/AudioUtilities.cpp",
    "audio/AudioUtilities.h",
    "audio/Biquad.cpp",
    "audio/Biquad.h",
    "audio/Cone.cpp",
    "audio/Cone.h",
    "audio/DenormalDisabler.h",
    "audio/DirectConvolver.cpp",
    "audio/DirectConvolver.h",
    "audio/Distance.cpp",
    "audio/Distance.h",
    "audio/DownSampler.cpp",
    "audio/DownSampler.h",
    "audio/DynamicsCompressor.cpp",
    "audio/DynamicsCompressor.h",
    "audio/DynamicsCompressorKernel.cpp",
    "audio/DynamicsCompressorKernel.h",
    "audio/EqualPowerPanner.cpp",
    "audio/EqualPowerPanner.h",
    "audio/FFTConvolver.cpp",
    "audio/FFTConvolver.h",
    "audio/FFTFrame.cpp",
    "audio/FFTFrame.h",
    "audio/FFTFrameStub.cpp",
    "audio/HRTFDatabase.cpp",
    "audio/HRTFDatabase.h",
    "audio/HRTFDatabaseLoader.cpp",
    "audio/HRTFDatabaseLoader.h",
    "audio/HRTFElevation.cpp",
    "audio/HRTFElevation.h",
    "audio/HRTFKernel.cpp",
    "audio/HRTFKernel.h",
    "audio/HRTFPanner.cpp",
    "audio/HRTFPanner.h",
    "audio/IIRFilter.cpp",
    "audio/IIRFilter.h",
    "audio/MultiChannelResampler.cpp",
    "audio/MultiChannelResampler.h",
    "audio/Panner.cpp",
    "audio/Panner.h",
    "audio/Reverb.cpp",
    "audio/Reverb.h",
    "audio/ReverbAccumulationBuffer.cpp",
    "audio/ReverbAccumulationBuffer.h",
    "audio/ReverbConvolver.cpp",
    "audio/ReverbConvolver.h",
    "audio/ReverbConvolverStage.cpp",
    "audio/ReverbConvolverStage.h",
    "audio/ReverbInputBuffer.cpp",
    "audio/ReverbInputBuffer.h",
    "audio/SincResampler.cpp",
    "audio/SincResampler.h",
    "audio/StereoPanner.cpp",
    "audio/StereoPanner.h",
    "audio/UpSampler.cpp",
    "audio/UpSampler.h",
    "audio/VectorMath.cpp",
    "audio/VectorMath.h",
    "audio/android/FFTFrameOpenMAXDLAndroid.cpp",
    "audio/ffmpeg/FFTFrameFFMPEG.cpp",
    "audio/ipp/FFTFrameIPP.cpp",
    "audio/mac/FFTFrameMac.cpp",
    "blob/BlobData.cpp",
    "blob/BlobData.h",
    "blob/BlobRegistry.cpp",
    "blob/BlobRegistry.h",
    "blob/BlobURL.cpp",
    "blob/BlobURL.h",
    "clipboard/ClipboardMimeTypes.cpp",
    "clipboard/ClipboardMimeTypes.h",
    "clipboard/ClipboardUtilities.cpp",
    "clipboard/ClipboardUtilities.h",
    "clipboard/ClipboardUtilitiesPosix.cpp",
    "clipboard/ClipboardUtilitiesWin.cpp",
    "cpu/mips/CommonMacrosMSA.h",
    "credentialmanager/PlatformCredential.cpp",
    "credentialmanager/PlatformCredential.h",
    "credentialmanager/PlatformFederatedCredential.cpp",
    "credentialmanager/PlatformFederatedCredential.h",
    "credentialmanager/PlatformPasswordCredential.cpp",
    "credentialmanager/PlatformPasswordCredential.h",
    "exported/InterfaceRegistry.cpp",
    "exported/Platform.cpp",
    "exported/ServiceRegistry.cpp",
    "exported/WebActiveGestureAnimation.cpp",
    "exported/WebActiveGestureAnimation.h",
    "exported/WebAudioBus.cpp",
    "exported/WebAudioDevice.cpp",
    "exported/WebBlobData.cpp",
    "exported/WebCanvasCaptureHandler.cpp",
    "exported/WebContentDecryptionModule.cpp",
    "exported/WebContentDecryptionModuleAccess.cpp",
    "exported/WebContentDecryptionModuleResult.cpp",
    "exported/WebContentDecryptionModuleSession.cpp",
    "exported/WebContentSettingCallbacks.cpp",
    "exported/WebCredential.cpp",
    "exported/WebCryptoAlgorithm.cpp",
    "exported/WebCryptoKey.cpp",
    "exported/WebCryptoKeyAlgorithm.cpp",
    "exported/WebCryptoResult.cpp",
    "exported/WebCursorInfo.cpp",
    "exported/WebData.cpp",
    "exported/WebDataConsumerHandle.cpp",
    "exported/WebDeviceMotionData.cpp",
    "exported/WebDeviceOrientationData.cpp",
    "exported/WebDragData.cpp",
    "exported/WebEncryptedMediaClient.cpp",
    "exported/WebEncryptedMediaKeyInformation.cpp",
    "exported/WebEncryptedMediaRequest.cpp",
    "exported/WebFederatedCredential.cpp",
    "exported/WebFileSystemCallbacks.cpp",
    "exported/WebFont.cpp",
    "exported/WebFontDescription.cpp",
    "exported/WebHTTPBody.cpp",
    "exported/WebHTTPLoadInfo.cpp",
    "exported/WebImage.cpp",
    "exported/WebImageGenerator.cpp",
    "exported/WebMediaConstraints.cpp",
    "exported/WebMediaDeviceInfo.cpp",
    "exported/WebMediaPlayerClient.cpp",
    "exported/WebMediaPlayerEncryptedMediaClient.cpp",
    "exported/WebMediaPlayerSource.cpp",
    "exported/WebMediaRecorderHandler.cpp",
    "exported/WebMediaStream.cpp",
    "exported/WebMediaStreamSource.cpp",
    "exported/WebMediaStreamTrack.cpp",
    "exported/WebMemoryCoordinator.cpp",
    "exported/WebMessagePortChannelClient.cpp",
    "exported/WebMixedContent.cpp",
    "exported/WebPasswordCredential.cpp",
    "exported/WebPrerender.cpp",
    "exported/WebPrerenderingSupport.cpp",
    "exported/WebPresentationAvailabilityObserver.cpp",
    "exported/WebPresentationController.cpp",
    "exported/WebPresentationReceiver.cpp",
    "exported/WebRTCAnswerOptions.cpp",
    "exported/WebRTCICECandidate.cpp",
    "exported/WebRTCOfferOptions.cpp",
    "exported/WebRTCSessionDescription.cpp",
    "exported/WebRTCSessionDescriptionRequest.cpp",
    "exported/WebRTCStatsRequest.cpp",
    "exported/WebRTCStatsResponse.cpp",
    "exported/WebRTCVoidRequest.cpp",
    "exported/WebScrollbarImpl.cpp",
    "exported/WebScrollbarImpl.h",
    "exported/WebScrollbarThemeClientImpl.cpp",
    "exported/WebScrollbarThemeClientImpl.h",
    "exported/WebScrollbarThemeGeometryNative.cpp",
    "exported/WebScrollbarThemeGeometryNative.h",
    "exported/WebScrollbarThemePainter.cpp",
    "exported/WebSecurityOrigin.cpp",
    "exported/WebServiceWorkerProviderClient.cpp",
    "exported/WebServiceWorkerProxy.cpp",
    "exported/WebServiceWorkerRequest.cpp",
    "exported/WebServiceWorkerResponse.cpp",
    "exported/WebSpeechSynthesisUtterance.cpp",
    "exported/WebSpeechSynthesisVoice.cpp",
    "exported/WebSpeechSynthesizerClientImpl.cpp",
    "exported/WebSpeechSynthesizerClientImpl.h",
    "exported/WebStorageQuotaCallbacks.cpp",
    "exported/WebTextRun.cpp",
    "exported/WebThreadSafeData.cpp",
    "exported/WebURL.cpp",
    "exported/WebURLError.cpp",
    "exported/WebURLLoadTiming.cpp",
    "exported/WebURLLoaderClient.cpp",
    "exported/WebURLLoaderTestDelegate.cpp",
    "exported/WebURLRequest.cpp",
    "exported/WebURLResponse.cpp",
    "exported/WrappedResourceRequest.h",
    "exported/WrappedResourceResponse.h",
    "feature_policy/FeaturePolicy.cpp",
    "feature_policy/FeaturePolicy.h",
    "fonts/AcceptLanguagesResolver.cpp",
    "fonts/AcceptLanguagesResolver.h",
    "fonts/AlternateFontFamily.h",
    "fonts/CharacterRange.h",
    "fonts/CustomFontData.h",
    "fonts/Font.cpp",
    "fonts/Font.h",
    "fonts/FontBaseline.h",
    "fonts/FontCache.cpp",
    "fonts/FontCache.h",
    "fonts/FontCacheClient.h",
    "fonts/FontCacheKey.h",
    "fonts/FontCacheMemoryDumpProvider.cpp",
    "fonts/FontCacheMemoryDumpProvider.h",
    "fonts/FontCustomPlatformData.cpp",
    "fonts/FontCustomPlatformData.h",
    "fonts/FontData.cpp",
    "fonts/FontData.h",
    "fonts/FontDataCache.cpp",
    "fonts/FontDataCache.h",
    "fonts/FontDataForRangeSet.cpp",
    "fonts/FontDataForRangeSet.h",
    "fonts/FontDescription.cpp",
    "fonts/FontFaceCreationParams.h",
    "fonts/FontFallbackIterator.cpp",
    "fonts/FontFallbackIterator.h",
    "fonts/FontFallbackList.cpp",
    "fonts/FontFallbackList.h",
    "fonts/FontFallbackPriority.cpp",
    "fonts/FontFallbackPriority.h",
    "fonts/FontFamily.cpp",
    "fonts/FontFamily.h",
    "fonts/FontFeatureSettings.cpp",
    "fonts/FontFeatureSettings.h",
    "fonts/FontPlatformData.cpp",
    "fonts/FontPlatformData.h",
    "fonts/FontVariantNumeric.h",
    "fonts/GenericFontFamilySettings.cpp",
    "fonts/GenericFontFamilySettings.h",
    "fonts/GlyphBuffer.h",
    "fonts/GlyphMetricsMap.h",
    "fonts/OrientationIterator.cpp",
    "fonts/OrientationIterator.h",
    "fonts/ScriptRunIterator.cpp",
    "fonts/ScriptRunIterator.h",
    "fonts/SegmentedFontData.cpp",
    "fonts/SegmentedFontData.h",
    "fonts/SimpleFontData.cpp",
    "fonts/SimpleFontData.h",
    "fonts/SmallCapsIterator.cpp",
    "fonts/SmallCapsIterator.h",
    "fonts/SymbolsIterator.cpp",
    "fonts/SymbolsIterator.h",
    "fonts/TextBlob.h",
    "fonts/UTF16TextIterator.cpp",
    "fonts/UTF16TextIterator.h",
    "fonts/UnicodeRangeSet.cpp",
    "fonts/UnicodeRangeSet.h",
    "fonts/VDMXParser.cpp",
    "fonts/VDMXParser.h",
    "fonts/WebFontDecoder.cpp",
    "fonts/WebFontDecoder.h",
    "fonts/android/FontCacheAndroid.cpp",
    "fonts/linux/FontCacheLinux.cpp",
    "fonts/linux/FontPlatformDataLinux.cpp",
    "fonts/linux/FontRenderStyle.cpp",
    "fonts/linux/FontRenderStyle.h",
    "fonts/mac/FontCacheMac.mm",
    "fonts/mac/FontFamilyMatcherMac.h",
    "fonts/mac/FontFamilyMatcherMac.mm",
    "fonts/mac/FontPlatformDataMac.mm",
    "fonts/opentype/OpenTypeCapsSupport.cpp",
    "fonts/opentype/OpenTypeCapsSupport.h",
    "fonts/opentype/OpenTypeCapsSupportMPL.cpp",
    "fonts/opentype/OpenTypeTypes.h",
    "fonts/opentype/OpenTypeVerticalData.cpp",
    "fonts/opentype/OpenTypeVerticalData.h",
    "fonts/shaping/CachingWordShapeIterator.cpp",
    "fonts/shaping/CachingWordShapeIterator.h",
    "fonts/shaping/CachingWordShaper.cpp",
    "fonts/shaping/CachingWordShaper.h",
    "fonts/shaping/CaseMappingHarfBuzzBufferFiller.cpp",
    "fonts/shaping/CaseMappingHarfBuzzBufferFiller.h",
    "fonts/shaping/HarfBuzzFace.cpp",
    "fonts/shaping/HarfBuzzFace.h",
    "fonts/shaping/HarfBuzzShaper.cpp",
    "fonts/shaping/HarfBuzzShaper.h",
    "fonts/shaping/RunSegmenter.cpp",
    "fonts/shaping/RunSegmenter.h",
    "fonts/shaping/ShapeCache.h",
    "fonts/shaping/ShapeResult.cpp",
    "fonts/shaping/ShapeResult.h",
    "fonts/shaping/ShapeResultBuffer.cpp",
    "fonts/shaping/ShapeResultBuffer.h",
    "fonts/shaping/ShapeResultInlineHeaders.h",
    "fonts/shaping/ShapeResultSpacing.cpp",
    "fonts/shaping/ShapeResultSpacing.h",
    "fonts/shaping/ShapeResultTestInfo.cpp",
    "fonts/shaping/ShapeResultTestInfo.h",
    "fonts/skia/FontCacheSkia.cpp",
    "fonts/skia/SkiaTextMetrics.cpp",
    "fonts/skia/SkiaTextMetrics.h",
    "fonts/win/FontCacheSkiaWin.cpp",
    "fonts/win/FontFallbackWin.cpp",
    "fonts/win/FontFallbackWin.h",
    "fonts/win/FontPlatformDataWin.cpp",
    "geometry/DoublePoint.cpp",
    "geometry/DoublePoint.h",
    "geometry/DoubleRect.cpp",
    "geometry/DoubleRect.h",
    "geometry/DoubleSize.cpp",
    "geometry/DoubleSize.h",
    "geometry/FloatBox.cpp",
    "geometry/FloatBox.h",
    "geometry/FloatPoint.cpp",
    "geometry/FloatPoint.h",
    "geometry/FloatPoint3D.cpp",
    "geometry/FloatPoint3D.h",
    "geometry/FloatPolygon.cpp",
    "geometry/FloatPolygon.h",
    "geometry/FloatQuad.cpp",
    "geometry/FloatQuad.h",
    "geometry/FloatRect.cpp",
    "geometry/FloatRect.h",
    "geometry/FloatRectOutsets.h",
    "geometry/FloatRoundedRect.cpp",
    "geometry/FloatRoundedRect.h",
    "geometry/FloatSize.cpp",
    "geometry/FloatSize.h",
    "geometry/IntPoint.cpp",
    "geometry/IntPoint.h",
    "geometry/IntRect.cpp",
    "geometry/IntRect.h",
    "geometry/IntRectOutsets.h",
    "geometry/IntSize.cpp",
    "geometry/IntSize.h",
    "geometry/IntSizeHash.h",
    "geometry/LayoutPoint.cpp",
    "geometry/LayoutPoint.h",
    "geometry/LayoutRect.cpp",
    "geometry/LayoutRect.h",
    "geometry/LayoutRectOutsets.cpp",
    "geometry/LayoutRectOutsets.h",
    "geometry/LayoutSize.cpp",
    "geometry/LayoutSize.h",
    "geometry/Region.cpp",
    "geometry/Region.h",
    "geometry/TransformState.cpp",
    "geometry/TransformState.h",
    "geometry/cg/FloatPointCG.cpp",
    "geometry/cg/FloatRectCG.cpp",
    "geometry/cg/FloatSizeCG.cpp",
    "geometry/cg/IntPointCG.cpp",
    "geometry/cg/IntRectCG.cpp",
    "geometry/cg/IntSizeCG.cpp",
    "geometry/mac/FloatPointMac.mm",
    "geometry/mac/FloatRectMac.mm",
    "geometry/mac/FloatSizeMac.mm",
    "geometry/mac/IntPointMac.mm",
    "geometry/mac/IntRectMac.mm",
    "geometry/mac/IntSizeMac.mm",
    "graphics/AcceleratedStaticBitmapImage.cpp",
    "graphics/AcceleratedStaticBitmapImage.h",
    "graphics/BitmapImage.cpp",
    "graphics/BitmapImage.h",
    "graphics/BitmapImageMetrics.cpp",
    "graphics/BitmapImageMetrics.h",
    "graphics/BoxReflection.cpp",
    "graphics/BoxReflection.h",
    "graphics/Canvas2DImageBufferSurface.h",
    "graphics/Canvas2DLayerBridge.cpp",
    "graphics/Canvas2DLayerBridge.h",
    "graphics/CanvasMetrics.cpp",
    "graphics/CanvasMetrics.h",
    "graphics/CanvasSurfaceLayerBridge.cpp",
    "graphics/CanvasSurfaceLayerBridge.h",
    "graphics/Color.cpp",
    "graphics/Color.h",
    "graphics/ColorSpace.cpp",
    "graphics/ColorSpace.h",
    "graphics/ColorSpaceProfileData.cpp",
    "graphics/ColorSpaceProfileData.h",
    "graphics/CompositingReasons.cpp",
    "graphics/CompositingReasons.h",
    "graphics/CompositorElementId.cpp",
    "graphics/CompositorElementId.h",
    "graphics/CompositorFilterOperations.cpp",
    "graphics/CompositorFilterOperations.h",
    "graphics/CompositorMutableState.cpp",
    "graphics/CompositorMutableState.h",
    "graphics/CompositorMutableStateProvider.cpp",
    "graphics/CompositorMutableStateProvider.h",
    "graphics/CompositorMutationsTarget.h",
    "graphics/CompositorMutator.h",
    "graphics/CompositorMutatorClient.cpp",
    "graphics/CompositorMutatorClient.h",
    "graphics/ContentLayerDelegate.cpp",
    "graphics/ContentLayerDelegate.h",
    "graphics/ContiguousContainer.cpp",
    "graphics/ContiguousContainer.h",
    "graphics/CrossfadeGeneratedImage.cpp",
    "graphics/CrossfadeGeneratedImage.h",
    "graphics/DecodingImageGenerator.cpp",
    "graphics/DecodingImageGenerator.h",
    "graphics/DeferredImageDecoder.cpp",
    "graphics/DeferredImageDecoder.h",
    "graphics/DrawLooperBuilder.cpp",
    "graphics/DrawLooperBuilder.h",
    "graphics/ExpensiveCanvasHeuristicParameters.h",
    "graphics/FirstPaintInvalidationTracking.cpp",
    "graphics/FirstPaintInvalidationTracking.h",
    "graphics/FrameData.cpp",
    "graphics/FrameData.h",
    "graphics/GeneratedImage.cpp",
    "graphics/GeneratedImage.h",
    "graphics/Gradient.cpp",
    "graphics/Gradient.h",
    "graphics/GradientGeneratedImage.cpp",
    "graphics/GradientGeneratedImage.h",
    "graphics/GraphicsContext.cpp",
    "graphics/GraphicsContext.h",
    "graphics/GraphicsContextState.cpp",
    "graphics/GraphicsContextState.h",
    "graphics/GraphicsContextStateSaver.h",
    "graphics/GraphicsLayer.cpp",
    "graphics/GraphicsLayer.h",
    "graphics/GraphicsLayerClient.h",
    "graphics/GraphicsLayerDebugInfo.cpp",
    "graphics/GraphicsLayerDebugInfo.h",
    "graphics/GraphicsTypes.cpp",
    "graphics/GraphicsTypes.h",
    "graphics/GraphicsTypes3D.h",
    "graphics/Image.cpp",
    "graphics/Image.h",
    "graphics/ImageAnimationPolicy.h",
    "graphics/ImageBuffer.cpp",
    "graphics/ImageBuffer.h",
    "graphics/ImageBufferClient.h",
    "graphics/ImageBufferSurface.cpp",
    "graphics/ImageBufferSurface.h",
    "graphics/ImageDecodingStore.cpp",
    "graphics/ImageDecodingStore.h",
    "graphics/ImageFrameGenerator.cpp",
    "graphics/ImageFrameGenerator.h",
    "graphics/ImageObserver.cpp",
    "graphics/ImageObserver.h",
    "graphics/ImageOrientation.cpp",
    "graphics/ImageOrientation.h",
    "graphics/ImagePattern.cpp",
    "graphics/ImagePattern.h",
    "graphics/ImageSource.cpp",
    "graphics/ImageSource.h",
    "graphics/InterceptingCanvas.cpp",
    "graphics/InterceptingCanvas.h",
    "graphics/LinkHighlight.h",
    "graphics/LoggingCanvas.cpp",
    "graphics/LoggingCanvas.h",
    "graphics/MailboxTextureHolder.cpp",
    "graphics/MailboxTextureHolder.h",
    "graphics/OffscreenCanvasFrameDispatcher.h",
    "graphics/OffscreenCanvasFrameDispatcherImpl.cpp",
    "graphics/OffscreenCanvasFrameDispatcherImpl.h",
    "graphics/OffscreenCanvasPlaceholder.cpp",
    "graphics/OffscreenCanvasPlaceholder.h",
    "graphics/PaintGeneratedImage.cpp",
    "graphics/PaintGeneratedImage.h",
    "graphics/PaintInvalidationReason.cpp",
    "graphics/PaintInvalidationReason.h",
    "graphics/Path.cpp",
    "graphics/Path.h",
    "graphics/PathTraversalState.cpp",
    "graphics/PathTraversalState.h",
    "graphics/Pattern.cpp",
    "graphics/Pattern.h",
    "graphics/PicturePattern.cpp",
    "graphics/PicturePattern.h",
    "graphics/PictureSnapshot.cpp",
    "graphics/PictureSnapshot.h",
    "graphics/PlaceholderImage.cpp",
    "graphics/PlaceholderImage.h",
    "graphics/ProfilingCanvas.cpp",
    "graphics/ProfilingCanvas.h",
    "graphics/RecordingImageBufferSurface.cpp",
    "graphics/RecordingImageBufferSurface.h",
    "graphics/ReplayingCanvas.cpp",
    "graphics/ReplayingCanvas.h",
    "graphics/SkiaTextureHolder.cpp",
    "graphics/SkiaTextureHolder.h",
    "graphics/SquashingDisallowedReasons.cpp",
    "graphics/SquashingDisallowedReasons.h",
    "graphics/StaticBitmapImage.cpp",
    "graphics/StaticBitmapImage.h",
    "graphics/StrokeData.cpp",
    "graphics/StrokeData.h",
    "graphics/TextureHolder.h",
    "graphics/UnacceleratedImageBufferSurface.cpp",
    "graphics/UnacceleratedImageBufferSurface.h",
    "graphics/UnacceleratedStaticBitmapImage.cpp",
    "graphics/UnacceleratedStaticBitmapImage.h",
    "graphics/WebGraphicsContext3DProviderWrapper.h",
    "graphics/compositing/PaintArtifactCompositor.cpp",
    "graphics/compositing/PaintArtifactCompositor.h",
    "graphics/cpu/arm/WebGLImageConversionNEON.h",
    "graphics/cpu/mips/WebGLImageConversionMSA.h",
    "graphics/cpu/x86/WebGLImageConversionSSE.h",
    "graphics/filters/DistantLightSource.cpp",
    "graphics/filters/DistantLightSource.h",
    "graphics/filters/FEBlend.cpp",
    "graphics/filters/FEBlend.h",
    "graphics/filters/FEBoxReflect.cpp",
    "graphics/filters/FEBoxReflect.h",
    "graphics/filters/FEColorMatrix.cpp",
    "graphics/filters/FEColorMatrix.h",
    "graphics/filters/FEComponentTransfer.cpp",
    "graphics/filters/FEComponentTransfer.h",
    "graphics/filters/FEComposite.cpp",
    "graphics/filters/FEComposite.h",
    "graphics/filters/FEConvolveMatrix.cpp",
    "graphics/filters/FEConvolveMatrix.h",
    "graphics/filters/FEDiffuseLighting.cpp",
    "graphics/filters/FEDiffuseLighting.h",
    "graphics/filters/FEDisplacementMap.cpp",
    "graphics/filters/FEDisplacementMap.h",
    "graphics/filters/FEDropShadow.cpp",
    "graphics/filters/FEDropShadow.h",
    "graphics/filters/FEFlood.cpp",
    "graphics/filters/FEFlood.h",
    "graphics/filters/FEGaussianBlur.cpp",
    "graphics/filters/FEGaussianBlur.h",
    "graphics/filters/FELighting.cpp",
    "graphics/filters/FELighting.h",
    "graphics/filters/FEMerge.cpp",
    "graphics/filters/FEMerge.h",
    "graphics/filters/FEMorphology.cpp",
    "graphics/filters/FEMorphology.h",
    "graphics/filters/FEOffset.cpp",
    "graphics/filters/FEOffset.h",
    "graphics/filters/FESpecularLighting.cpp",
    "graphics/filters/FESpecularLighting.h",
    "graphics/filters/FETile.cpp",
    "graphics/filters/FETile.h",
    "graphics/filters/FETurbulence.cpp",
    "graphics/filters/FETurbulence.h",
    "graphics/filters/Filter.cpp",
    "graphics/filters/Filter.h",
    "graphics/filters/FilterEffect.cpp",
    "graphics/filters/FilterEffect.h",
    "graphics/filters/LightSource.cpp",
    "graphics/filters/LightSource.h",
    "graphics/filters/PaintFilterEffect.cpp",
    "graphics/filters/PaintFilterEffect.h",
    "graphics/filters/PointLightSource.cpp",
    "graphics/filters/PointLightSource.h",
    "graphics/filters/SkiaImageFilterBuilder.cpp",
    "graphics/filters/SkiaImageFilterBuilder.h",
    "graphics/filters/SourceAlpha.cpp",
    "graphics/filters/SourceAlpha.h",
    "graphics/filters/SourceGraphic.cpp",
    "graphics/filters/SourceGraphic.h",
    "graphics/filters/SpotLightSource.cpp",
    "graphics/filters/SpotLightSource.h",
    "graphics/gpu/AcceleratedImageBufferSurface.cpp",
    "graphics/gpu/AcceleratedImageBufferSurface.h",
    "graphics/gpu/DrawingBuffer.cpp",
    "graphics/gpu/DrawingBuffer.h",
    "graphics/gpu/Extensions3DUtil.cpp",
    "graphics/gpu/Extensions3DUtil.h",
    "graphics/gpu/SharedContextRateLimiter.cpp",
    "graphics/gpu/SharedContextRateLimiter.h",
    "graphics/gpu/SharedGpuContext.cpp",
    "graphics/gpu/SharedGpuContext.h",
    "graphics/gpu/WebGLImageConversion.cpp",
    "graphics/gpu/WebGLImageConversion.h",
    "graphics/paint/ClipDisplayItem.cpp",
    "graphics/paint/ClipDisplayItem.h",
    "graphics/paint/ClipPaintPropertyNode.cpp",
    "graphics/paint/ClipPaintPropertyNode.h",
    "graphics/paint/ClipPathDisplayItem.cpp",
    "graphics/paint/ClipPathDisplayItem.h",
    "graphics/paint/ClipPathRecorder.cpp",
    "graphics/paint/ClipPathRecorder.h",
    "graphics/paint/ClipRecorder.cpp",
    "graphics/paint/ClipRecorder.h",
    "graphics/paint/CompositingDisplayItem.cpp",
    "graphics/paint/CompositingDisplayItem.h",
    "graphics/paint/CompositingRecorder.cpp",
    "graphics/paint/CompositingRecorder.h",
    "graphics/paint/CullRect.cpp",
    "graphics/paint/CullRect.h",
    "graphics/paint/DisplayItem.cpp",
    "graphics/paint/DisplayItem.h",
    "graphics/paint/DisplayItemCacheSkipper.h",
    "graphics/paint/DisplayItemClient.cpp",
    "graphics/paint/DisplayItemClient.h",
    "graphics/paint/DisplayItemList.cpp",
    "graphics/paint/DisplayItemList.h",
    "graphics/paint/DrawingDisplayItem.cpp",
    "graphics/paint/DrawingDisplayItem.h",
    "graphics/paint/DrawingRecorder.cpp",
    "graphics/paint/DrawingRecorder.h",
    "graphics/paint/EffectPaintPropertyNode.cpp",
    "graphics/paint/EffectPaintPropertyNode.h",
    "graphics/paint/FilterDisplayItem.cpp",
    "graphics/paint/FilterDisplayItem.h",
    "graphics/paint/FloatClipDisplayItem.cpp",
    "graphics/paint/FloatClipDisplayItem.h",
    "graphics/paint/ForeignLayerDisplayItem.cpp",
    "graphics/paint/ForeignLayerDisplayItem.h",
    "graphics/paint/GeometryMapper.cpp",
    "graphics/paint/GeometryMapper.h",
    "graphics/paint/PaintArtifact.cpp",
    "graphics/paint/PaintArtifact.h",
    "graphics/paint/PaintChunk.h",
    "graphics/paint/PaintChunkProperties.h",
    "graphics/paint/PaintChunker.cpp",
    "graphics/paint/PaintChunker.h",
    "graphics/paint/PaintController.cpp",
    "graphics/paint/PaintController.h",
    "graphics/paint/PropertyTreeState.h",
    "graphics/paint/RasterInvalidationTracking.cpp",
    "graphics/paint/RasterInvalidationTracking.h",
    "graphics/paint/ScopedPaintChunkProperties.h",
    "graphics/paint/ScrollDisplayItem.cpp",
    "graphics/paint/ScrollDisplayItem.h",
    "graphics/paint/ScrollPaintPropertyNode.cpp",
    "graphics/paint/ScrollPaintPropertyNode.h",
    "graphics/paint/SkPictureBuilder.cpp",
    "graphics/paint/SkPictureBuilder.h",
    "graphics/paint/SubsequenceDisplayItem.h",
    "graphics/paint/SubsequenceRecorder.cpp",
    "graphics/paint/SubsequenceRecorder.h",
    "graphics/paint/Transform3DDisplayItem.cpp",
    "graphics/paint/Transform3DDisplayItem.h",
    "graphics/paint/TransformDisplayItem.cpp",
    "graphics/paint/TransformDisplayItem.h",
    "graphics/paint/TransformPaintPropertyNode.cpp",
    "graphics/paint/TransformPaintPropertyNode.h",
    "graphics/skia/ImagePixelLocker.cpp",
    "graphics/skia/ImagePixelLocker.h",
    "graphics/skia/SkSizeHash.h",
    "graphics/skia/SkiaUtils.cpp",
    "graphics/skia/SkiaUtils.h",
    "image-decoders/FastSharedBufferReader.cpp",
    "image-decoders/FastSharedBufferReader.h",
    "image-decoders/ImageAnimation.h",
    "image-decoders/ImageDecoder.cpp",
    "image-decoders/ImageDecoder.h",
    "image-decoders/ImageFrame.cpp",
    "image-decoders/ImageFrame.h",
    "image-decoders/SegmentReader.cpp",
    "image-decoders/SegmentReader.h",
    "image-decoders/bmp/BMPImageDecoder.cpp",
    "image-decoders/bmp/BMPImageDecoder.h",
    "image-decoders/bmp/BMPImageReader.cpp",
    "image-decoders/bmp/BMPImageReader.h",
    "image-decoders/gif/GIFImageDecoder.cpp",
    "image-decoders/gif/GIFImageDecoder.h",
    "image-decoders/gif/GIFImageReader.cpp",
    "image-decoders/gif/GIFImageReader.h",
    "image-decoders/ico/ICOImageDecoder.cpp",
    "image-decoders/ico/ICOImageDecoder.h",
    "image-decoders/jpeg/JPEGImageDecoder.cpp",
    "image-decoders/jpeg/JPEGImageDecoder.h",
    "image-decoders/png/PNGImageDecoder.cpp",
    "image-decoders/png/PNGImageDecoder.h",
    "image-decoders/png/PNGImageReader.cpp",
    "image-decoders/png/PNGImageReader.h",
    "image-decoders/webp/WEBPImageDecoder.cpp",
    "image-decoders/webp/WEBPImageDecoder.h",
    "image-encoders/ImageEncoderUtils.cpp",
    "image-encoders/ImageEncoderUtils.h",
    "image-encoders/JPEGImageEncoder.cpp",
    "image-encoders/JPEGImageEncoder.h",
    "image-encoders/PNGImageEncoder.cpp",
    "image-encoders/PNGImageEncoder.h",
    "image-encoders/WEBPImageEncoder.cpp",
    "image-encoders/WEBPImageEncoder.h",
    "json/JSONParser.cpp",
    "json/JSONParser.h",
    "json/JSONValues.cpp",
    "json/JSONValues.h",
    "mac/BlockExceptions.h",
    "mac/BlockExceptions.mm",
    "mac/ColorMac.h",
    "mac/ColorMac.mm",
    "mac/KillRingMac.mm",
    "mac/LocalCurrentGraphicsContext.h",
    "mac/LocalCurrentGraphicsContext.mm",
    "mac/NSScrollerImpDetails.h",
    "mac/ScrollAnimatorMac.h",
    "mac/ScrollAnimatorMac.mm",
    "mac/ThemeMac.h",
    "mac/ThemeMac.mm",
    "mac/VersionUtilMac.h",
    "mac/VersionUtilMac.mm",
    "mac/WebCoreNSCellExtras.h",
    "mac/WebCoreNSCellExtras.mm",
    "mediastream/MediaStreamCenter.cpp",
    "mediastream/MediaStreamCenter.h",
    "mediastream/MediaStreamComponent.cpp",
    "mediastream/MediaStreamComponent.h",
    "mediastream/MediaStreamDescriptor.cpp",
    "mediastream/MediaStreamDescriptor.h",
    "mediastream/MediaStreamSource.cpp",
    "mediastream/MediaStreamSource.h",
    "mediastream/MediaStreamWebAudioSource.cpp",
    "mediastream/MediaStreamWebAudioSource.h",
    "mhtml/ArchiveResource.cpp",
    "mhtml/MHTMLArchive.cpp",
    "mhtml/MHTMLArchive.h",
    "mhtml/MHTMLParser.cpp",
    "mhtml/MHTMLParser.h",
    "mojo/CommonCustomTypesStructTraits.cpp",
    "mojo/GeometryStructTraits.cpp",
    "mojo/MojoHelper.h",
    "network/ContentSecurityPolicyParsers.cpp",
    "network/ContentSecurityPolicyParsers.h",
    "network/ContentSecurityPolicyResponseHeaders.cpp",
    "network/ContentSecurityPolicyResponseHeaders.h",
    "network/EncodedFormData.cpp",
    "network/EncodedFormData.h",
    "network/FormDataEncoder.cpp",
    "network/FormDataEncoder.h",
    "network/HTTPHeaderMap.cpp",
    "network/HTTPHeaderMap.h",
    "network/HTTPParsers.cpp",
    "network/HTTPParsers.h",
    "network/LinkHeader.cpp",
    "network/LinkHeader.h",
    "network/NetworkHints.cpp",
    "network/NetworkHints.h",
    "network/NetworkInstrumentation.cpp",
    "network/NetworkInstrumentation.h",
    "network/NetworkLog.h",
    "network/NetworkUtils.cpp",
    "network/NetworkUtils.h",
    "network/ParsedContentType.cpp",
    "network/ParsedContentType.h",
    "network/ResourceError.cpp",
    "network/ResourceError.h",
    "network/ResourceLoadTiming.cpp",
    "network/ResourceLoadTiming.h",
    "network/ResourceRequest.cpp",
    "network/ResourceRequest.h",
    "network/ResourceResponse.cpp",
    "network/ResourceResponse.h",
    "network/ResourceTimingInfo.cpp",
    "network/ResourceTimingInfo.h",
    "network/WebSocketHandshakeRequest.cpp",
    "network/WebSocketHandshakeRequest.h",
    "network/WebSocketHandshakeResponse.cpp",
    "network/WebSocketHandshakeResponse.h",
    "network/mime/MIMETypeRegistry.cpp",
    "peerconnection/RTCAnswerOptionsPlatform.h",
    "peerconnection/RTCOfferOptionsPlatform.h",
    "peerconnection/RTCSessionDescriptionRequest.h",
    "peerconnection/RTCStatsRequest.h",
    "peerconnection/RTCStatsResponseBase.h",
    "peerconnection/RTCVoidRequest.h",
    "plugins/PluginData.cpp",
    "plugins/PluginData.h",
    "plugins/PluginListBuilder.cpp",
    "plugins/PluginListBuilder.h",
    "scheduler/CancellableTaskFactory.cpp",
    "scheduler/CancellableTaskFactory.h",
    "scheduler/base/cancelable_closure_holder.cc",
    "scheduler/base/cancelable_closure_holder.h",
    "scheduler/base/enqueue_order.cc",
    "scheduler/base/enqueue_order.h",
    "scheduler/base/intrusive_heap.h",
    "scheduler/base/lazy_now.cc",
    "scheduler/base/lazy_now.h",
    "scheduler/base/pollable_thread_safe_flag.cc",
    "scheduler/base/pollable_thread_safe_flag.h",
    "scheduler/base/queueing_time_estimator.cc",
    "scheduler/base/queueing_time_estimator.h",
    "scheduler/base/real_time_domain.cc",
    "scheduler/base/real_time_domain.h",
    "scheduler/base/task_queue_impl.cc",
    "scheduler/base/task_queue_impl.h",
    "scheduler/base/task_queue_manager.cc",
    "scheduler/base/task_queue_manager.h",
    "scheduler/base/task_queue_manager_delegate.h",
    "scheduler/base/task_queue_selector.cc",
    "scheduler/base/task_queue_selector.h",
    "scheduler/base/thread_load_tracker.cc",
    "scheduler/base/thread_load_tracker.h",
    "scheduler/base/time_domain.cc",
    "scheduler/base/time_domain.h",
    "scheduler/base/virtual_time_domain.cc",
    "scheduler/base/virtual_time_domain.h",
    "scheduler/base/work_queue.cc",
    "scheduler/base/work_queue.h",
    "scheduler/base/work_queue_sets.cc",
    "scheduler/base/work_queue_sets.h",
    "scheduler/child/compositor_worker_scheduler.cc",
    "scheduler/child/idle_helper.cc",
    "scheduler/child/idle_helper.h",
    "scheduler/child/scheduler_helper.cc",
    "scheduler/child/scheduler_helper.h",
    "scheduler/child/scheduler_tqm_delegate.h",
    "scheduler/child/scheduler_tqm_delegate_impl.cc",
    "scheduler/child/scheduler_tqm_delegate_impl.h",
    "scheduler/child/single_thread_idle_task_runner.cc",
    "scheduler/child/web_scheduler_impl.cc",
    "scheduler/child/web_scheduler_impl.h",
    "scheduler/child/web_task_runner_impl.cc",
    "scheduler/child/web_task_runner_impl.h",
    "scheduler/child/webthread_base.cc",
    "scheduler/child/webthread_impl_for_worker_scheduler.cc",
    "scheduler/child/worker_scheduler.cc",
    "scheduler/child/worker_scheduler_impl.cc",
    "scheduler/child/worker_scheduler_impl.h",
    "scheduler/renderer/auto_advancing_virtual_time_domain.cc",
    "scheduler/renderer/auto_advancing_virtual_time_domain.h",
    "scheduler/renderer/deadline_task_runner.cc",
    "scheduler/renderer/deadline_task_runner.h",
    "scheduler/renderer/idle_time_estimator.cc",
    "scheduler/renderer/idle_time_estimator.h",
    "scheduler/renderer/render_widget_scheduling_state.cc",
    "scheduler/renderer/render_widget_signals.cc",
    "scheduler/renderer/render_widget_signals.h",
    "scheduler/renderer/renderer_scheduler.cc",
    "scheduler/renderer/renderer_scheduler_impl.cc",
    "scheduler/renderer/renderer_scheduler_impl.h",
    "scheduler/renderer/renderer_web_scheduler_impl.cc",
    "scheduler/renderer/renderer_web_scheduler_impl.h",
    "scheduler/renderer/task_cost_estimator.cc",
    "scheduler/renderer/task_cost_estimator.h",
    "scheduler/renderer/task_queue_throttler.cc",
    "scheduler/renderer/task_queue_throttler.h",
    "scheduler/renderer/throttled_time_domain.cc",
    "scheduler/renderer/throttled_time_domain.h",
    "scheduler/renderer/user_model.cc",
    "scheduler/renderer/user_model.h",
    "scheduler/renderer/web_frame_scheduler_impl.cc",
    "scheduler/renderer/web_frame_scheduler_impl.h",
    "scheduler/renderer/web_view_scheduler_impl.cc",
    "scheduler/renderer/web_view_scheduler_impl.h",
    "scheduler/renderer/webthread_impl_for_renderer_scheduler.cc",
    "scheduler/renderer/webthread_impl_for_renderer_scheduler.h",
    "scheduler/utility/webthread_impl_for_utility_thread.cc",
    "scroll/MainThreadScrollingReason.h",
    "scroll/ProgrammaticScrollAnimator.cpp",
    "scroll/ProgrammaticScrollAnimator.h",
    "scroll/ScrollAnimator.cpp",
    "scroll/ScrollAnimator.h",
    "scroll/ScrollAnimatorBase.cpp",
    "scroll/ScrollAnimatorBase.h",
    "scroll/ScrollAnimatorCompositorCoordinator.cpp",
    "scroll/ScrollAnimatorCompositorCoordinator.h",
    "scroll/ScrollStateData.h",
    "scroll/ScrollTypes.h",
    "scroll/ScrollableArea.cpp",
    "scroll/ScrollableArea.h",
    "scroll/Scrollbar.cpp",
    "scroll/Scrollbar.h",
    "scroll/ScrollbarTheme.cpp",
    "scroll/ScrollbarTheme.h",
    "scroll/ScrollbarThemeAndroid.cpp",
    "scroll/ScrollbarThemeAura.cpp",
    "scroll/ScrollbarThemeAura.h",
    "scroll/ScrollbarThemeClient.h",
    "scroll/ScrollbarThemeMac.h",
    "scroll/ScrollbarThemeMac.mm",
    "scroll/ScrollbarThemeMock.cpp",
    "scroll/ScrollbarThemeMock.h",
    "scroll/ScrollbarThemeOverlay.cpp",
    "scroll/ScrollbarThemeOverlay.h",
    "scroll/ScrollbarThemeOverlayMock.h",
    "speech/PlatformSpeechSynthesisUtterance.cpp",
    "speech/PlatformSpeechSynthesisUtterance.h",
    "speech/PlatformSpeechSynthesisVoice.cpp",
    "speech/PlatformSpeechSynthesisVoice.h",
    "speech/PlatformSpeechSynthesizer.cpp",
    "speech/PlatformSpeechSynthesizer.h",
    "text/BidiCharacterRun.cpp",
    "text/BidiCharacterRun.h",
    "text/BidiContext.cpp",
    "text/BidiContext.h",
    "text/BidiResolver.h",
    "text/BidiRunList.h",
    "text/BidiTextRun.cpp",
    "text/BidiTextRun.h",
    "text/Character.cpp",
    "text/Character.h",
    "text/CharacterEmoji.cpp",
    "text/DateTimeFormat.cpp",
    "text/DateTimeFormat.h",
    "text/DecodeEscapeSequences.h",
    "text/Hyphenation.cpp",
    "text/Hyphenation.h",
    "text/LineEnding.cpp",
    "text/LineEnding.h",
    "text/LocaleICU.cpp",
    "text/LocaleICU.h",
    "text/LocaleMac.h",
    "text/LocaleMac.mm",
    "text/LocaleToScriptMapping.cpp",
    "text/LocaleToScriptMapping.h",
    "text/LocaleWin.cpp",
    "text/LocaleWin.h",
    "text/PlatformLocale.cpp",
    "text/PlatformLocale.h",
    "text/QuotedPrintable.cpp",
    "text/QuotedPrintable.h",
    "text/SegmentedString.cpp",
    "text/SegmentedString.h",
    "text/StringTruncator.cpp",
    "text/StringTruncator.h",
    "text/SuffixTree.h",
    "text/TextBoundaries.cpp",
    "text/TextBoundaries.h",
    "text/TextBreakIterator.cpp",
    "text/TextBreakIterator.h",
    "text/TextBreakIteratorICU.cpp",
    "text/TextBreakIteratorInternalICU.cpp",
    "text/TextBreakIteratorInternalICU.h",
    "text/TextCheckerClient.cpp",
    "text/TextCheckerClient.h",
    "text/TextChecking.h",
    "text/TextDecoration.h",
    "text/TextEncodingDetector.cpp",
    "text/TextEncodingDetector.h",
    "text/TextRun.cpp",
    "text/TextRun.h",
    "text/TextRunIterator.h",
    "text/TextStream.cpp",
    "text/TextStream.h",
    "text/UnicodeBidi.h",
    "text/UnicodeRange.cpp",
    "text/UnicodeRange.h",
    "text/UnicodeUtilities.cpp",
    "text/UnicodeUtilities.h",
    "text/linux/HyphenationLinux.cpp",
    "text/mac/HyphenationMac.cpp",
    "text/win/HyphenationWin.cpp",
    "threading/BackgroundTaskRunner.cpp",
    "threading/BackgroundTaskRunner.h",
    "tracing/MemoryCacheDumpProvider.cpp",
    "tracing/MemoryCacheDumpProvider.h",
    "tracing/TraceEvent.h",
    "tracing/TracedValue.cpp",
    "tracing/TracedValue.h",
    "tracing/web_memory_allocator_dump.cc",
    "tracing/web_memory_allocator_dump.h",
    "tracing/web_process_memory_dump.cc",
    "tracing/web_process_memory_dump.h",
    "transforms/AffineTransform.cpp",
    "transforms/AffineTransform.h",
    "transforms/IdentityTransformOperation.h",
    "transforms/InterpolatedTransformOperation.cpp",
    "transforms/InterpolatedTransformOperation.h",
    "transforms/Matrix3DTransformOperation.cpp",
    "transforms/Matrix3DTransformOperation.h",
    "transforms/MatrixTransformOperation.cpp",
    "transforms/MatrixTransformOperation.h",
    "transforms/PerspectiveTransformOperation.cpp",
    "transforms/PerspectiveTransformOperation.h",
    "transforms/RotateTransformOperation.cpp",
    "transforms/RotateTransformOperation.h",
    "transforms/Rotation.cpp",
    "transforms/Rotation.h",
    "transforms/ScaleTransformOperation.cpp",
    "transforms/ScaleTransformOperation.h",
    "transforms/SkewTransformOperation.cpp",
    "transforms/SkewTransformOperation.h",
    "transforms/TransformOperations.cpp",
    "transforms/TransformationMatrix.cpp",
    "transforms/TransformationMatrix.h",
    "transforms/TranslateTransformOperation.cpp",
    "transforms/TranslateTransformOperation.h",
    "weborigin/KURL.cpp",
    "weborigin/KURL.h",
    "weborigin/KURLHash.h",
    "weborigin/KnownPorts.cpp",
    "weborigin/KnownPorts.h",
    "weborigin/OriginAccessEntry.cpp",
    "weborigin/OriginAccessEntry.h",
    "weborigin/Referrer.h",
    "weborigin/ReferrerPolicy.h",
    "weborigin/SchemeRegistry.cpp",
    "weborigin/SchemeRegistry.h",
    "weborigin/SecurityOrigin.cpp",
    "weborigin/SecurityOrigin.h",
    "weborigin/SecurityOriginHash.h",
    "weborigin/SecurityPolicy.cpp",
    "weborigin/SecurityPolicy.h",
    "weborigin/Suborigin.cpp",
    "weborigin/Suborigin.h",
    "weborigin/URLSecurityOriginMap.h",
  ]

  sources -= blink_platform_neon_files
  sources -= blink_platform_msa_files
  sources -= blink_platform_sse_files

  # Add in the generated files.
  sources += get_target_outputs(":character_data") +
             get_target_outputs(":color_data") +
             get_target_outputs(":font_family_names") +
             get_target_outputs(":http_names") +
             get_target_outputs(":runtime_enabled_features")

  configs += [
    # TODO(jschuh): crbug.com/167187 fix size_t to int truncations.
    "//build/config/compiler:no_size_t_to_int_warning",
    "//third_party/WebKit/Source:config",
    "//third_party/WebKit/Source:non_test_config",
  ]

  defines = [
    "BLINK_PLATFORM_IMPLEMENTATION=1",
    "INSIDE_BLINK",
  ]

  include_dirs = [
    #"$angle_path/include",
    "$root_gen_dir/blink",
  ]

  public_deps = [
    ":make_platform_generated",
    "//base",
    "//cc",
    "//gpu/command_buffer/client:client",
    "//gpu/command_buffer/client:gles2_c_lib",
    "//gpu/command_buffer/client:gles2_interface",
    "//gpu/command_buffer/common:common",
    "//media",
    "//net",
    "//skia",
    "//third_party:jpeg",
    "//third_party/WebKit/Source/wtf",
    "//third_party/WebKit/public:mojo_bindings_blink",
    "//third_party/iccjpeg",
    "//third_party/libpng",
    "//third_party/libwebp",
    "//third_party/ots",
    "//url",
    "//v8",
  ]
  deps = [
    ":blink_common",
    "//components/link_header_util:link_header_util",
    "//components/mime_util:mime_util",
    "//mojo/public/cpp/bindings",
    "//mojo/public/cpp/bindings:wtf_support",
    "//third_party/WebKit/Source/platform/heap",
    "//third_party/WebKit/public:mojo_bindings_blink",
    "//third_party/WebKit/public:offscreen_canvas_mojo_bindings_blink",
    "//third_party/ced",
    "//third_party/harfbuzz-ng",
    "//third_party/icu",
    "//ui/gfx",
    "//ui/gfx/geometry",
  ]

  if (is_mac) {
    sources -= [
      "fonts/skia/FontCacheSkia.cpp",
      "scroll/ScrollAnimator.cpp",
      "scroll/ScrollAnimator.h",

      # Uses LocaleMac instead.
      "text/LocaleICU.cpp",
      "text/LocaleICU.h",
    ]

    if (appstore_compliant_code) {
      sources -= [
        "mac/KillRingMac.mm"
      ]
    } else {
      sources -= [
        # Uses KillRingMac.mm instead.
        "KillRingNone.cpp",
      ]
    }

    configs += [ "//third_party/WebKit/Source:mac_precompiled_headers" ]
    libs = [
      "AppKit.framework",
      "Accelerate.framework",
      "Carbon.framework",
      "Foundation.framework",
    ]
  } else {
    sources -= [
      "geometry/cg/FloatPointCG.cpp",
      "geometry/cg/FloatRectCG.cpp",
      "geometry/cg/FloatSizeCG.cpp",
      "geometry/cg/IntPointCG.cpp",
      "geometry/cg/IntRectCG.cpp",
      "geometry/cg/IntSizeCG.cpp",
    ]
  }

  if (is_win) {
    sources -= [
      "clipboard/ClipboardUtilitiesPosix.cpp",

      # Uses LocaleWin instead.
      "text/LocaleICU.cpp",
      "text/LocaleICU.h",
    ]
    cflags = [
      "/wd4334",  # Result of 32-bit shift implicitly converted to 64 bits.
      "/wd4724",  # Modulo by 0.
    ]
  } else {
    sources -= [
      "clipboard/ClipboardUtilitiesWin.cpp",
      "text/LocaleWin.cpp",
    ]
  }

  if (is_android) {
    # Add in some Linux files also shared with Android.
    set_sources_assignment_filter([])
    sources += [
      "fonts/linux/FontPlatformDataLinux.cpp",
      "fonts/linux/FontRenderStyle.cpp",
      "fonts/linux/FontRenderStyle.h",
    ]
    set_sources_assignment_filter(sources_assignment_filter)
  } else {
    sources -= [ "scroll/ScrollbarThemeAndroid.cpp" ]
  }

  if (use_minikin_hyphenation) {
    sources += [
      "text/hyphenation/HyphenationMinikin.cpp",
      "text/hyphenation/HyphenatorAOSP.cpp",
      "text/hyphenation/HyphenatorAOSP.h",
    ]
  }

  if (!use_default_render_theme) {
    sources -= [
      "scroll/ScrollbarThemeAura.cpp",
      "scroll/ScrollbarThemeAura.h",
    ]
  }

  if (current_cpu == "arm") {
    deps += [ ":blink_arm_neon" ]
  }

  if (current_cpu == "mipsel" || current_cpu == "mips64el") {
    deps += [ ":blink_mips_msa" ]
  }

  if (current_cpu == "x86" || current_cpu == "x64") {
    deps += [ ":blink_x86_sse" ]
  }

  if (use_webaudio_ffmpeg) {
    include_dirs += [ "//third_party/ffmpeg" ]
    deps += [ "//third_party/ffmpeg" ]
  }
  if (use_openmax_dl_fft) {
    include_dirs += [ "//third_party/openmax_dl" ]
    deps += [ "//third_party/openmax_dl/dl" ]
  }

  if (remove_webcore_debug_symbols) {
    configs -= [ "//build/config/compiler:default_symbols" ]
    configs += [ "//build/config/compiler:no_symbols" ]
  }
}

static_library("test_support") {
  visibility += [ "//third_party/WebKit/*" ]
  testonly = true

  sources = [
    "network/mime/MockMimeRegistry.h",
    "scheduler/base/task_queue_manager_delegate_for_test.cc",
    "scheduler/base/test_time_source.cc",
    "scheduler/child/scheduler_tqm_delegate_for_test.cc",
    "scheduler/test/fake_renderer_scheduler.cc",
    "scheduler/test/fake_web_task_runner.cc",
    "scheduler/test/fake_web_task_runner.h",
    "scheduler/test/lazy_scheduler_message_loop_delegate_for_tests.cc",
    "scheduler/test/lazy_scheduler_message_loop_delegate_for_tests.h",
    "scheduler/test/renderer_scheduler_test_support.cc",
    "scroll/ScrollbarTestSuite.h",
    "testing/CompositorTest.cpp",
    "testing/CompositorTest.h",
    "testing/FakeDisplayItemClient.h",
    "testing/FakeGraphicsLayer.h",
    "testing/FakeGraphicsLayerClient.h",
    "testing/FontTestHelpers.cpp",
    "testing/FontTestHelpers.h",
    "testing/FuzzedDataProvider.cpp",
    "testing/FuzzedDataProvider.h",
    "testing/GeometryPrinters.cpp",
    "testing/GeometryPrinters.h",
    "testing/HistogramTester.cpp",
    "testing/HistogramTester.h",
    "testing/MessageLoopForMojo.h",
    "testing/PaintPrinters.cpp",
    "testing/PaintPrinters.h",
    "testing/PictureMatchers.cpp",
    "testing/PictureMatchers.h",
    "testing/PlatformTestPrinters.cpp",
    "testing/RuntimeEnabledFeaturesTestHelpers.h",
    "testing/TestPaintArtifact.cpp",
    "testing/TestPaintArtifact.h",
    "testing/TestingPlatformSupport.cpp",
    "testing/TestingPlatformSupport.h",
    "testing/TransformPrinters.cpp",
    "testing/TransformPrinters.h",
    "testing/URLTestHelpers.cpp",
    "testing/URLTestHelpers.h",
    "testing/UnitTestHelpers.cpp",
    "testing/UnitTestHelpers.h",
    "testing/WebLayerTreeViewImplForTesting.cpp",
    "testing/WebLayerTreeViewImplForTesting.h",
    "testing/weburl_loader_mock.cc",
    "testing/weburl_loader_mock.h",
    "testing/weburl_loader_mock_factory_impl.cc",
    "testing/weburl_loader_mock_factory_impl.h",
  ]

  configs += [
    "//third_party/WebKit/Source:config",
    "//third_party/WebKit/Source:inside_blink",
    "//third_party/WebKit/Source:non_test_config",
  ]

  public_deps = [
    ":platform",
    "//cc",
    "//cc:test_support",
    "//cc/blink",
    "//testing/gmock",
    "//testing/gtest:gtest",
  ]

  deps = [
    "//base/test:test_support",
    "//mojo/edk/system",
  ]

  if (is_win) {
    cflags = [ "/wd4267" ]  # Truncation from size_t to int.
  }
}

test("blink_platform_unittests") {
  visibility = []  # Allow re-assignment of list.
  visibility = [ "*" ]

  sources = [
    "DecimalTest.cpp",
    "DragImageTest.cpp",
    "HistogramTest.cpp",
    "LayoutLocaleTest.cpp",
    "LayoutUnitTest.cpp",
    "LifecycleContextTest.cpp",
    "PODArenaTest.cpp",
    "PODFreeListArenaTest.cpp",
    "PODIntervalTreeTest.cpp",
    "PODRedBlackTreeTest.cpp",
    "ScopedOrientationChangeIndicatorTest.cpp",
    "SharedBufferTest.cpp",
    "TimerTest.cpp",
    "UUIDTest.cpp",
    "UserGestureIndicatorTest.cpp",
    "WebIconSizesParserTest.cpp",
    "WebScreenInfoTest.cpp",
    "WebTaskRunnerTest.cpp",
    "WebVectorTest.cpp",
    "animation/AnimationTranslationUtilTest.cpp",
    "animation/CompositorAnimationHostTest.cpp",
    "animation/CompositorAnimationPlayerTest.cpp",
    "animation/CompositorAnimationTest.cpp",
    "animation/CompositorAnimationTimelineTest.cpp",
    "animation/CompositorFloatAnimationCurveTest.cpp",
    "animation/TimingFunctionTest.cpp",
    "blob/BlobDataTest.cpp",
    "clipboard/ClipboardUtilitiesTest.cpp",
    "exported/FilePathConversionTest.cpp",
    "feature_policy/FeaturePolicyTest.cpp",
    "fonts/AcceptLanguagesResolverTest.cpp",
    "fonts/FontCacheTest.cpp",
    "fonts/FontDescriptionTest.cpp",
    "fonts/FontPlatformDataTest.cpp",
    "fonts/FontTest.cpp",
    "fonts/GenericFontFamilySettingsTest.cpp",
    "fonts/GlyphBufferTest.cpp",
    "fonts/OrientationIteratorTest.cpp",
    "fonts/ScriptRunIteratorTest.cpp",
    "fonts/SmallCapsIteratorTest.cpp",
    "fonts/SymbolsIteratorTest.cpp",
    "fonts/UnicodeRangeSetTest.cpp",
    "fonts/android/FontCacheAndroidTest.cpp",
    "fonts/mac/FontFamilyMatcherMacTest.mm",
    "fonts/opentype/OpenTypeVerticalDataTest.cpp",
    "fonts/shaping/CachingWordShaperTest.cpp",
    "fonts/shaping/HarfBuzzShaperTest.cpp",
    "fonts/shaping/RunSegmenterTest.cpp",
    "geometry/DoubleRectTest.cpp",
    "geometry/FloatBoxTest.cpp",
    "geometry/FloatBoxTestHelpers.cpp",
    "geometry/FloatPointTest.cpp",
    "geometry/FloatPolygonTest.cpp",
    "geometry/FloatQuadTest.cpp",
    "geometry/FloatRectTest.cpp",
    "geometry/FloatRoundedRectTest.cpp",
    "geometry/FloatSizeTest.cpp",
    "geometry/GeometryTestHelpers.cpp",
    "geometry/IntRectTest.cpp",
    "geometry/LayoutRectOutsetsTest.cpp",
    "geometry/LayoutRectTest.cpp",
    "geometry/RegionTest.cpp",
    "graphics/BitmapImageTest.cpp",
    "graphics/CompositorMutableStateTest.cpp",
    "graphics/CompositorMutatorClientTest.cpp",
    "graphics/ContiguousContainerTest.cpp",
    "graphics/DeferredImageDecoderTestWoPlatform.cpp",
    "graphics/GraphicsContextTest.cpp",
    "graphics/RecordingImageBufferSurfaceTest.cpp",
    "graphics/compositing/PaintArtifactCompositorTest.cpp",
    "graphics/filters/ImageFilterBuilderTest.cpp",
    "graphics/gpu/DrawingBufferTest.cpp",
    "graphics/gpu/SharedGpuContextTest.cpp",
    "graphics/gpu/WebGLImageConversionTest.cpp",
    "graphics/paint/DisplayItemClientTest.cpp",
    "graphics/paint/DisplayItemListTest.cpp",
    "graphics/paint/DisplayItemTest.cpp",
    "graphics/paint/GeometryMapperTest.cpp",
    "graphics/paint/PaintChunkTest.cpp",
    "graphics/paint/PaintChunkerTest.cpp",
    "graphics/paint/PaintControllerTest.cpp",
    "image-decoders/FastSharedBufferReaderTest.cpp",
    "image-decoders/ImageDecoderTest.cpp",
    "image-decoders/ImageDecoderTestHelpers.cpp",
    "image-decoders/ImageDecoderTestHelpers.h",
    "image-decoders/bmp/BMPImageDecoderTest.cpp",
    "image-decoders/gif/GIFImageDecoderTest.cpp",
    "image-decoders/ico/ICOImageDecoderTest.cpp",
    "image-decoders/jpeg/JPEGImageDecoderTest.cpp",
    "image-decoders/webp/WEBPImageDecoderTest.cpp",
    "json/JSONParserTest.cpp",
    "json/JSONValuesTest.cpp",
    "mac/VersionUtilMacTest.mm",
    "mojo/CommonCustomTypesStructTraitsTest.cpp",
    "mojo/GeometryStructTraitsTest.cpp",
    "mojo/KURLSecurityOriginTest.cpp",
    "network/EncodedFormDataTest.cpp",
    "network/HTTPParsersTest.cpp",
    "network/LinkHeaderTest.cpp",
    "network/NetworkUtilsTest.cpp",
    "network/ResourceRequestTest.cpp",
    "network/ResourceResponseTest.cpp",
    "network/mime/MIMETypeRegistryTest.cpp",
    "scheduler/CancellableTaskFactoryTest.cpp",
    "scheduler/base/intrusive_heap_unittest.cc",
    "scheduler/base/queueing_time_estimator_unittest.cc",
    "scheduler/base/task_queue_manager_unittest.cc",
    "scheduler/base/task_queue_selector_unittest.cc",
    "scheduler/base/test_count_uses_time_source.cc",
    "scheduler/base/thread_load_tracker_unittest.cc",
    "scheduler/base/time_domain_unittest.cc",
    "scheduler/base/work_queue_sets_unittest.cc",
    "scheduler/base/work_queue_unittest.cc",
    "scheduler/child/idle_helper_unittest.cc",
    "scheduler/child/scheduler_helper_unittest.cc",
    "scheduler/child/scheduler_tqm_delegate_impl_unittest.cc",
    "scheduler/child/webthread_impl_for_worker_scheduler_unittest.cc",
    "scheduler/child/worker_scheduler_impl_unittest.cc",
    "scheduler/renderer/auto_advancing_virtual_time_domain_unittest.cc",
    "scheduler/renderer/deadline_task_runner_unittest.cc",
    "scheduler/renderer/idle_time_estimator_unittest.cc",
    "scheduler/renderer/renderer_scheduler_impl_unittest.cc",
    "scheduler/renderer/task_cost_estimator_unittest.cc",
    "scheduler/renderer/task_queue_throttler_unittest.cc",
    "scheduler/renderer/user_model_unittest.cc",
    "scheduler/renderer/web_frame_scheduler_impl_unittest.cc",
    "scheduler/renderer/web_view_scheduler_impl_unittest.cc",
    "scheduler/renderer/webthread_impl_for_renderer_scheduler_unittest.cc",
    "scroll/ScrollableAreaTest.cpp",
    "testing/ArenaTestHelpers.h",
    "testing/TreeTestHelpers.cpp",
    "testing/TreeTestHelpers.h",
    "text/BidiResolverTest.cpp",
    "text/CharacterTest.cpp",
    "text/DateTimeFormatTest.cpp",
    "text/HyphenationTest.cpp",
    "text/SegmentedStringTest.cpp",
    "text/TextBreakIteratorTest.cpp",
    "text/TextEncodingDetectorTest.cpp",
    "text/UnicodeUtilitiesTest.cpp",
    "threading/BackgroundTaskRunnerTest.cpp",
    "tracing/TracedValueTest.cpp",
    "tracing/web_process_memory_dump_test.cc",
    "transforms/AffineTransformTest.cpp",
    "transforms/RotationTest.cpp",
    "transforms/TransformOperationsTest.cpp",
    "transforms/TransformationMatrixTest.cpp",
    "weborigin/KURLTest.cpp",
    "weborigin/KnownPortsTest.cpp",
    "weborigin/OriginAccessEntryTest.cpp",
    "weborigin/SchemeRegistryTest.cpp",
    "weborigin/SecurityOriginTest.cpp",
    "weborigin/SecurityPolicyTest.cpp",
    "weborigin/SuboriginTest.cpp",
  ]

  if (is_win) {
    sources += [ "text/LocaleWinTest.cpp" ]
  } else if (is_mac) {
    sources += [ "text/LocaleMacTest.cpp" ]
  } else if (is_posix) {
    sources += [ "text/LocaleICUTest.cpp" ]
  }

  if (!is_mac) {
    sources += [ "scroll/ScrollAnimatorTest.cpp" ]
  }

  if (use_default_render_theme) {
    sources += [ "scroll/ScrollbarThemeAuraTest.cpp" ]
  }

  sources += [ "testing/RunAllTests.cpp" ]

  configs += [
    "//third_party/WebKit/Source/wtf:wtf_config",
    "//third_party/WebKit/Source:config",
  ]

  deps = [
    ":blink_common",
    ":platform",
    ":test_support",
    "//base",
    "//base/test:test_support",
    "//cc",
    "//cc:test_support",
    "//cc/blink",
    "//mojo/common:test_common_custom_types_blink",
    "//mojo/edk/embedder:headers",
    "//mojo/edk/test:test_support",
    "//mojo/public/cpp/bindings/tests:for_blink_tests",
    "//skia",
    "//testing/gmock",
    "//testing/gtest",
    "//third_party/WebKit/Source/wtf",
    "//third_party/harfbuzz-ng",
    "//ui/gfx",
    "//ui/gfx/geometry",
    "//ui/gfx/geometry/mojo:test_interfaces_blink",
    "//url",
    "//url/mojo:test_url_mojom_gurl_blink",
  ]

  data_deps = [
    ":blink_platform_unittests_data",
  ]

  defines = [ "INSIDE_BLINK" ]

  include_dirs = [ "$root_gen_dir/blink" ]
}

test("blink_platform_perftests") {
  sources = [
    "scheduler/base/task_queue_manager_delegate_for_test.cc",
    "scheduler/base/task_queue_manager_delegate_for_test.h",
    "scheduler/base/task_queue_manager_perftest.cc",
  ]

  configs += [
    # TODO(jschuh): crbug.com/167187 fix size_t to int truncations.
    "//build/config/compiler:no_size_t_to_int_warning",
    "//third_party/WebKit/Source/wtf:wtf_config",
    "//third_party/WebKit/Source:config",
  ]

  deps = [
    ":blink_common",
    ":platform",
    "//base",
    "//base/test:test_support",
    "//base/test:test_support_perf",
    "//testing/gtest",
    "//testing/perf",
  ]
}

group("blink_platform_unittests_data") {
  data = [
    "testing/data/",

    # Required by some image decoder tests.
    "image-decoders/testing/",
    "../../LayoutTests/images/resources/",
  ]
}

if (current_cpu == "arm") {
  source_set("blink_arm_neon") {
    sources = blink_platform_neon_files

    # The *NEON.cpp files fail to compile when -mthumb is passed. Force
    # them to build in ARM mode.
    # See https://bugs.webkit.org/show_bug.cgi?id=62916.
    # TODO(GYP)
    #'cflags': ['-marm'],
    #    'conditions': [
    #      ['OS=="android"', {
    #        'cflags!': ['-mthumb'],
    #      }],
    #    ],

    deps = [
      ":blink_common",
    ]
  }
}

if (current_cpu == "mipsel" || current_cpu == "mips64el") {
  source_set("blink_mips_msa") {
    sources = blink_platform_msa_files
    deps = [
      ":blink_common",
    ]
  }
}

if (current_cpu == "x86" || current_cpu == "x64") {
  source_set("blink_x86_sse") {
    sources = blink_platform_sse_files
    deps = [
      ":blink_common",
    ]
  }
}

# This source set is used for fuzzers that need an environment similar to unit
# tests.
source_set("blink_fuzzer_test_support") {
  testonly = true
  visibility = []  # Allow re-assignment of list.
  visibility = [ "*" ]
  sources = [
    "testing/BlinkFuzzerTestSupport.cpp",
    "testing/BlinkFuzzerTestSupport.h",
  ]
  deps = [
    ":platform",
    ":test_support",
    "//content/test:test_support",
  ]
}

# Fuzzer for blink::MHTMLParser.
fuzzer_test("mhtml_parser_fuzzer") {
  sources = [
    "mhtml/MHTMLFuzzer.cpp",
  ]
  deps = [
    ":blink_common",
    ":platform",
    ":test_support",
  ]
  dict = "//testing/libfuzzer/fuzzers/dicts/mhtml.dict"
  seed_corpus = "//third_party/WebKit/LayoutTests/mhtml"
  additional_configs = [
    "//third_party/WebKit/Source/wtf:wtf_config",
    "//third_party/WebKit/Source:config",
  ]
}

# Fuzzer for blink::WebIconSizesParser.
fuzzer_test("web_icon_sizes_fuzzer") {
  sources = [
    "WebIconSizesFuzzer.cpp",
  ]
  deps = [
    ":blink_fuzzer_test_support",
    ":platform",
  ]
  dict = "//testing/libfuzzer/fuzzers/dicts/web_icon_sizes.dict"
}

# Fuzzer for blink::JSONParser.
fuzzer_test("blink_json_parser_fuzzer") {
  sources = [
    "json/JSONParserFuzzer.cpp",
  ]
  deps = [
    ":blink_fuzzer_test_support",
    ":platform",
  ]
  dict = "//testing/libfuzzer/fuzzers/dicts/json.dict"
}

# Fuzzer for blink::FeaturePolicy.
fuzzer_test("feature_policy_fuzzer") {
  sources = [
    "feature_policy/FeaturePolicyFuzzer.cpp",
  ]
  deps = [
    ":blink_fuzzer_test_support",
    ":platform",
  ]
  dict = "//testing/libfuzzer/fuzzers/dicts/feature_policy.dict"
  seed_corpus = "//testing/libfuzzer/fuzzers/feature_policy_corpus"
}

# NOTE: These are legacy unit tests and tests that require a Platform
# object. Do not add more unless the test requires a Platform object.
# These tests are a part of the webkit_unit_tests binary.
source_set("unit_tests") {
  testonly = true
  visibility = []
  visibility = [ "//third_party/WebKit/Source/*" ]
  sources = [
    "graphics/Canvas2DLayerBridgeTest.cpp",
    "graphics/CanvasSurfaceLayerBridgeTest.cpp",
    "graphics/DeferredImageDecoderTest.cpp",
    "graphics/GraphicsLayerTest.cpp",
    "graphics/ImageDecodingStoreTest.cpp",
    "graphics/ImageFrameGeneratorTest.cpp",
    "graphics/ImageLayerChromiumTest.cpp",
    "graphics/gpu/DrawingBufferSoftwareRenderingTest.cpp",
    "graphics/test/FakeGLES2Interface.h",
    "graphics/test/FakeWebGraphicsContext3DProvider.h",
    "graphics/test/MockImageDecoder.h",
  ]

  configs += [
    "//third_party/WebKit/Source:config",
    "//third_party/WebKit/Source:inside_blink",
  ]

  deps = [
    ":test_support",
    "//cc/surfaces:surface_id",
    "//testing/gmock",
    "//testing/gtest",
  ]
}
